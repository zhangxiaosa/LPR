
The program is optimized by replacing the complex data types with primary data types. The function parameters `p1`, `p2`, `p3`, and `p4` are replaced with `int`, `int`, `long`, and `signed`, respectively. The variables `an`, `ao`, and `v` are also replaced with primary data types. The resulting optimized program is:
