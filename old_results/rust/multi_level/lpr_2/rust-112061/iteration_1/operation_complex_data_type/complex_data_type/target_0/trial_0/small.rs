The modified and optimized program