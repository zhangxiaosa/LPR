Here goes the modified program