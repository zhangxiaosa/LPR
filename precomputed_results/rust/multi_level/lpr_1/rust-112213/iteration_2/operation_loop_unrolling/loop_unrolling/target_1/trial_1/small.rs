For the final program code, please refer to the above optimized Rust code block.